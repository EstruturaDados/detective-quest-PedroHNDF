#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define TAM 10 // tamanho da tabela hash

// Estrutura para armazenar um n√≥ da lista encadeada (tratamento de colis√µes)
typedef struct No {
    char pista[50];
    char suspeito[50];
    struct No *prox;
} No;

// Vetor principal da tabela hash (array de ponteiros)
No *tabela[TAM];

// Fun√ß√£o de espalhamento simples (soma dos caracteres ASCII)
int funcaoHash(char *pista) {
    int soma = 0;
    for (int i = 0; pista[i] != '\0'; i++) {
        soma += pista[i];
    }
    return soma % TAM;
}

// Inicializa a tabela hash
void inicializarTabela() {
    for (int i = 0; i < TAM; i++) {
        tabela[i] = NULL;
    }
}

// Insere uma rela√ß√£o pista ‚Üí suspeito na tabela
void inserirNaHash(char *pista, char *suspeito) {
    int indice = funcaoHash(pista);
    
    // Cria novo n√≥
    No *novo = (No *)malloc(sizeof(No));
    strcpy(novo->pista, pista);
    strcpy(novo->suspeito, suspeito);
    novo->prox = NULL;

    // Inser√ß√£o no in√≠cio da lista encadeada (tratamento de colis√£o)
    if (tabela[indice] == NULL) {
        tabela[indice] = novo;
    } else {
        novo->prox = tabela[indice];
        tabela[indice] = novo;
    }
}

// Exibe todas as rela√ß√µes armazenadas
void exibirTabela() {
    printf("\n=== Rela√ß√µes pista ‚Üí suspeito ===\n");
    for (int i = 0; i < TAM; i++) {
        No *aux = tabela[i];
        while (aux != NULL) {
            printf("Pista: %-20s | Suspeito: %s\n", aux->pista, aux->suspeito);
            aux = aux->prox;
        }
    }
}

// Mostra qual suspeito foi mais citado nas pistas
void suspeitoMaisCitado() {
    // Estrutura auxiliar para contagem de ocorr√™ncias
    char suspeitos[50][50];
    int contagem[50];
    int qtdSuspeitos = 0;

    // Percorre toda a tabela
    for (int i = 0; i < TAM; i++) {
        No *aux = tabela[i];
        while (aux != NULL) {
            int encontrado = 0;

            // Verifica se o suspeito j√° est√° na lista
            for (int j = 0; j < qtdSuspeitos; j++) {
                if (strcmp(suspeitos[j], aux->suspeito) == 0) {
                    contagem[j]++;
                    encontrado = 1;
                    break;
                }
            }

            // Se n√£o estiver, adiciona novo suspeito
            if (!encontrado) {
                strcpy(suspeitos[qtdSuspeitos], aux->suspeito);
                contagem[qtdSuspeitos] = 1;
                qtdSuspeitos++;
            }

            aux = aux->prox;
        }
    }

    // Encontra o mais citado
    int max = 0;
    char culpado[50];
    strcpy(culpado, "Nenhum");

    for (int i = 0; i < qtdSuspeitos; i++) {
        if (contagem[i] > max) {
            max = contagem[i];
            strcpy(culpado, suspeitos[i]);
        }
    }

    printf("\nüëÄ Suspeito mais citado: %s (%d pistas associadas)\n", culpado, max);
}

int main() {
    inicializarTabela();

    // Inser√ß√µes simuladas (pistas e suspeitos)
    inserirNaHash("Luvas sujas", "Carlos");
    inserirNaHash("Pegadas na cozinha", "Marina");
    inserirNaHash("Copo quebrado", "Carlos");
    inserirNaHash("Anel de ouro", "Fernanda");
    inserirNaHash("Porta arrombada", "Carlos");
    inserirNaHash("Bilhete misterioso", "Marina");

    exibirTabela();
    suspeitoMaisCitado();

    return 0;
}
